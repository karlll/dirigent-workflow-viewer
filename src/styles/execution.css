/* ============================================
   Workflow Execution State Styles
   All styles scoped to .workflow-viewer
   ============================================ */

/* ============================================
   Execution Path Highlighting
   ============================================ */

.workflow-viewer .on-execution-path {
  box-shadow: 0 0 12px color-mix(in srgb, var(--workflow-execution-path) 50%, transparent) !important;
}

/* Override completed/failed borders for execution path */
.workflow-viewer .node-completed.on-execution-path,
.workflow-viewer .node-failed.on-execution-path,
.workflow-viewer .node-running.on-execution-path,
.workflow-viewer .node-pending.on-execution-path {
  border: 3px solid var(--workflow-execution-path) !important;
}

/* Current executing step */
.workflow-viewer .current-step {
  border: 2px solid var(--workflow-current-step) !important;
  animation: wfv-pulse 2s ease-in-out infinite;
}

@keyframes wfv-pulse {
  0%, 100% {
    box-shadow: 0 0 12px color-mix(in srgb, var(--workflow-current-step) 50%, transparent);
  }
  50% {
    box-shadow: 0 0 24px color-mix(in srgb, var(--workflow-current-step) 80%, transparent);
  }
}

/* ============================================
   Step Execution States
   ============================================ */

.workflow-viewer .node-pending {
  opacity: 0.5;
}

.workflow-viewer .node-running {
  background: linear-gradient(to bottom,
    color-mix(in srgb, var(--workflow-state-running) 15%, var(--wfv-card)) 0%,
    color-mix(in srgb, var(--workflow-state-running) 25%, var(--wfv-card)) 100%) !important;
  border-color: var(--workflow-state-running) !important;
}

.workflow-viewer .node-completed {
  background: linear-gradient(to bottom,
    color-mix(in srgb, var(--workflow-state-completed) 15%, var(--wfv-card)) 0%,
    color-mix(in srgb, var(--workflow-state-completed) 25%, var(--wfv-card)) 100%) !important;
  border-color: var(--workflow-state-completed) !important;
}

.workflow-viewer .node-failed {
  background: linear-gradient(to bottom,
    color-mix(in srgb, var(--workflow-state-failed) 15%, var(--wfv-card)) 0%,
    color-mix(in srgb, var(--workflow-state-failed) 25%, var(--wfv-card)) 100%) !important;
  border-color: var(--workflow-state-failed) !important;
}

.workflow-viewer .node-skipped {
  opacity: 0.3;
  filter: grayscale(100%);
}

/* ============================================
   Execution Status Indicators
   ============================================ */

.workflow-viewer .node-header-icons {
  display: flex;
  align-items: center;
  gap: 8px;
}

.workflow-viewer .execution-status {
  display: flex;
  align-items: center;
  margin-left: auto;
}

.workflow-viewer .execution-status svg {
  color: inherit;
}

/* Running state animation */
.workflow-viewer .node-running .execution-status svg.animate-spin {
  color: var(--workflow-state-running);
}

/* Completed state icon */
.workflow-viewer .node-completed .execution-status svg {
  color: var(--workflow-state-completed);
}

/* Failed state icon */
.workflow-viewer .node-failed .execution-status svg {
  color: var(--workflow-state-failed);
}

/* ============================================
   Execution Timing Display
   ============================================ */

.workflow-viewer .execution-timing {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--wfv-muted-foreground);
  margin-top: 4px;
  padding: 4px 8px;
  background: var(--wfv-muted);
  border-radius: 4px;
  font-family: 'Monaco', 'Courier New', monospace;
}

.workflow-viewer .execution-timing svg {
  flex-shrink: 0;
  color: var(--wfv-muted-foreground);
}

/* ============================================
   Error Message Display
   ============================================ */

.workflow-viewer .execution-error {
  display: flex;
  align-items: flex-start;
  gap: 4px;
  font-size: 12px;
  color: var(--wfv-destructive);
  background: color-mix(in srgb, var(--wfv-destructive) 15%, var(--wfv-card));
  padding: 8px;
  border-radius: 4px;
  margin-top: 8px;
  border-left: 3px solid var(--wfv-destructive);
}

.workflow-viewer .execution-error svg {
  flex-shrink: 0;
  margin-top: 2px;
  color: var(--wfv-destructive);
}

.workflow-viewer .execution-error span {
  word-break: break-word;
}

/* ============================================
   React Flow Edge Highlighting
   ============================================ */

/* Highlight edges on execution path */
.workflow-viewer .react-flow__edge.on-execution-path path {
  stroke: var(--workflow-execution-path) !important;
  stroke-width: 4 !important;
}

.workflow-viewer .react-flow__edge.on-execution-path.animated path {
  stroke-dasharray: 5;
  animation: wfv-dashdraw 0.5s linear infinite;
}

@keyframes wfv-dashdraw {
  0% { stroke-dashoffset: 0; }
  100% { stroke-dashoffset: 10; }
}

/* Edge markers (arrowheads) on execution path */
.workflow-viewer .react-flow__edge.on-execution-path .react-flow__edge-path {
  stroke: var(--workflow-execution-path) !important;
}

.workflow-viewer .react-flow__edge.on-execution-path marker {
  fill: var(--workflow-execution-path) !important;
}

.workflow-viewer .react-flow__edge.on-execution-path marker path {
  fill: var(--workflow-execution-path) !important;
  stroke: var(--workflow-execution-path) !important;
}

/* ============================================
   Dark Mode Overrides
   ============================================ */

/* Most dark mode styling is now handled by CSS variables in theme.css.
   No additional overrides needed as the variables automatically adapt. */

/* ============================================
   Color Utilities for CVA Variants
   ============================================ */

/* These utilities are used by CVA variants in src/lib/variants.ts
   and need to be explicitly defined since Tailwind can't detect
   dynamically constructed class names */

/* Background colors */
.workflow-viewer .bg-primary {
  background-color: var(--primary);
}

.workflow-viewer .bg-primary\/10 {
  background-color: color-mix(in srgb, var(--primary) 10%, transparent);
}

.workflow-viewer .bg-primary\/20 {
  background-color: color-mix(in srgb, var(--primary) 20%, transparent);
}

.workflow-viewer .bg-muted {
  background-color: var(--muted);
}

.workflow-viewer .bg-muted\/50 {
  background-color: color-mix(in srgb, var(--muted) 50%, transparent);
}

.workflow-viewer .bg-muted\/10 {
  background-color: color-mix(in srgb, var(--muted) 10%, transparent);
}

.workflow-viewer .bg-destructive {
  background-color: var(--destructive);
}

.workflow-viewer .bg-destructive\/10 {
  background-color: color-mix(in srgb, var(--destructive) 10%, transparent);
}

.workflow-viewer .bg-destructive\/20 {
  background-color: color-mix(in srgb, var(--destructive) 20%, transparent);
}

.workflow-viewer .bg-ctp-green {
  background-color: var(--ctp-green);
}

.workflow-viewer .bg-ctp-green\/10 {
  background-color: color-mix(in srgb, var(--ctp-green) 10%, transparent);
}

.workflow-viewer .bg-ctp-green\/20 {
  background-color: color-mix(in srgb, var(--ctp-green) 20%, transparent);
}

/* Text colors */
.workflow-viewer .text-primary {
  color: var(--primary);
}

.workflow-viewer .text-muted-foreground {
  color: var(--muted-foreground);
}

.workflow-viewer .text-destructive {
  color: var(--destructive);
}

.workflow-viewer .text-ctp-green {
  color: var(--ctp-green);
}

/* Border colors */
.workflow-viewer .border-primary {
  border-color: var(--primary);
}

.workflow-viewer .border-border {
  border-color: var(--border);
}

.workflow-viewer .border-muted-foreground {
  border-color: var(--muted-foreground);
}

.workflow-viewer .border-destructive {
  border-color: var(--destructive);
}

.workflow-viewer .border-ctp-green {
  border-color: var(--ctp-green);
}

/* Ring colors */
.workflow-viewer .ring-primary {
  --tw-ring-color: var(--primary);
}

.workflow-viewer .ring-destructive {
  --tw-ring-color: var(--destructive);
}

.workflow-viewer .ring-ctp-green {
  --tw-ring-color: var(--ctp-green);
}

/* Hover states */
.workflow-viewer .hover\:bg-primary\/20:hover {
  background-color: color-mix(in srgb, var(--primary) 20%, transparent);
}

.workflow-viewer .hover\:bg-ctp-green\/20:hover {
  background-color: color-mix(in srgb, var(--ctp-green) 20%, transparent);
}

.workflow-viewer .hover\:bg-destructive\/20:hover {
  background-color: color-mix(in srgb, var(--destructive) 20%, transparent);
}

.workflow-viewer .hover\:border-muted-foreground:hover {
  border-color: var(--muted-foreground);
}
